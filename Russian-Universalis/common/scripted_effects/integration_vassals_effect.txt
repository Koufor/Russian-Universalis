vassal_integration_process_calc = {
	hidden_effect = {
		if = {
			limit = { always = yes }
			country_event = { id = vassal_integration.103 days = 1 }
		}
	}
}

vassals_adm_integration_effect = {
	# Административная интеграция
	every_subject_country = {
		limit = { 
			is_subject_of_type = vassal
			check_variable = { which = Years_as_Vassal value = 1 }
			NOT = { liberty_desire = 50 }
		}
		
		set_variable = { which = ADM_integration_process value = 10 }
		
		# Размер вассала - влияние на интеграцию 
		if = {
			limit = { is_subject_other_than_tributary_trigger = yes }
			trigger_switch = {
				on_trigger = total_development
				1001 = {
					divide_variable = { which = ADM_integration_process value = 0.05 }
				}
				751 = {
					divide_variable = { which = ADM_integration_process value = 0.1 }
				}
				501 = {
					divide_variable = { which = ADM_integration_process value = 0.25 }
				}
				351 = {
					divide_variable = { which = ADM_integration_process value = 0.35 }
				}
				251 = {
					divide_variable = { which = ADM_integration_process value = 0.5 }
				}
				201 = {
					divide_variable = { which = ADM_integration_process value = 0.75 }
				}
				151 = {
					divide_variable = { which = ADM_integration_process value = 1 }
				}
				126 = {
					divide_variable = { which = ADM_integration_process value = 1.25 }
				}
				101 = {
					divide_variable = { which = ADM_integration_process value = 1.5 }
				}
				76 = {
					divide_variable = { which = ADM_integration_process value = 2 }
				}
				51 = {
					divide_variable = { which = ADM_integration_process value = 2.25 }
				}
				26 = {
					divide_variable = { which = ADM_integration_process value = 2.75 }
				}
				1 = {
					divide_variable = { which = ADM_integration_process value = 3 }
				}
			}
		}
		
		# Флаг - Единая бюрократия
		if = {
			limit = { has_country_flag = vassal_integration_adm_unity_burecracy }
			divide_variable = { which = ADM_integration_process value = 1.5 }
		}
		# Флаг - Уравнивание сословий
		if = {
			limit = { has_country_flag = vassal_integration_adm_estates }
			divide_variable = { which = ADM_integration_process value = 1.25 }
		}
		# Флаг - Единая налоговая система
		if = {
			limit = { has_country_flag = vassal_integration_adm_taxes_system }
			divide_variable = { which = ADM_integration_process value = 1.35 }
		}
		# Флаг - Новые наместники
		if = {
			limit = { has_country_flag = vassal_integration_adm_new_governors }
			divide_variable = { which = ADM_integration_process value = 1.1 }
		}
		# Флаг - Гарантированные привилегии
		if = {
			limit = { has_country_flag = vassal_integration_adm_garanted_privileges }
			divide_variable = { which = ADM_integration_process value = 0.5 }
		}
		
		# Принят институт Народное сознание
		if = {
			limit = { has_institution = hhh_dt_l }
			divide_variable = { which = ADM_integration_process value = 0.85 }
		}
		# Принят институт Национализм
		if = {
			limit = { has_institution = nationalism_institution }
			divide_variable = { which = ADM_integration_process value = 0.75 }
		}
		
		# Сюзерен
		overlord = {
			# Советник
			if = {
				limit = { has_advisor = philosopher }
				PREV = { divide_variable = { which = ADM_integration_process value = 1.25 } }
			}
			
			# Принят институт Империализм
			if = {
				limit = { has_institution = imperialism }
				PREV = { divide_variable = { which = ADM_integration_process value = 1.35 } }
			}
			
			# Влияние технологий (Адм)
			if = {
				limit = { adm_tech = 50 }
				PREV = { divide_variable = { which = ADM_integration_process value = 1.2 } }
			}
			else_if = {
				limit = { adm_tech = 45 }
				PREV = { divide_variable = { which = ADM_integration_process value = 1 } }
			}
			else_if = {
				limit = { adm_tech = 30 }
				PREV = { divide_variable = { which = ADM_integration_process value = 0.8 } }
			}
			else_if = {
				limit = { adm_tech = 15 }
				PREV = { divide_variable = { which = ADM_integration_process value = 0.6 } }
			}
			else_if = {
				limit = { adm_tech = 5 }
				PREV = { divide_variable = { which = ADM_integration_process value = 0.4 } }
			}
			else_if = {
				limit = { adm_tech = 1 }
				PREV = { divide_variable = { which = ADM_integration_process value = 0.2 } }
			}
			
			# Влияние культуры и религии
			if = {
				limit = { primary_culture = PREV }
				PREV = { divide_variable = { which = ADM_integration_process value = 1.2 } }
			}
			else_if = {
				limit = { culture_group = PREV }
				PREV = { divide_variable = { which = ADM_integration_process value = 1.05 } }
			}
			if = {
				limit = { NOT = { religion = PREV } }
				PREV = { divide_variable = { which = ADM_integration_process value = 0.8 } }
			}
			else_if = {
				limit = { NOT = { religion_group = PREV } }
				PREV = { divide_variable = { which = ADM_integration_process value = 0.2 } }
			}
			
			# Влияние модификатора Низкой Организации
			if = {
				limit = { has_country_modifier = hhh_dark_times }
				divide_variable = { which = ADM_integration_process value = 0.2 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_light }
				divide_variable = { which = ADM_integration_process value = 0.3 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_s }
				divide_variable = { which = ADM_integration_process value = 0.4 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_s_light }
				divide_variable = { which = ADM_integration_process value = 0.5 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_t }
				divide_variable = { which = ADM_integration_process value = 0.6 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_t_light }
				divide_variable = { which = ADM_integration_process value = 0.7 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_l }
				divide_variable = { which = ADM_integration_process value = 0.8 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_l_light }
				divide_variable = { which = ADM_integration_process value = 0.9 }
			}
		}
		
		#Подведение итога
		multiply_variable = { which = ADM_integration_process value = 10 }
		set_variable = { which = Remaining_Years_ADM which = ADM_integration_process }
		subtract_variable = { which = Remaining_Years_ADM which = Years_as_Vassal }
		
		set_variable = { which = PreSent_integration_ADM which = Years_as_Vassal }
		multiply_variable = { which = PreSent_integration_ADM value = 100 }
		if = {
			limit = {
				is_variable_equal = {
					which = ADM_integration_process
					value = 0
				}
			}
		}
		else = {
			divide_variable = {
				which = PreSent_integration_ADM
				which = ADM_integration_process
			}
		}
	}
}

vassals_dip_integration_effect = {
	#Дипломатическая интеграция
	every_subject_country = {
		limit = { 
			is_subject_of_type = vassal
			check_variable = { which = Years_as_Vassal value = 1 }
			NOT = { liberty_desire = 50 }
		}
		
		set_variable = { which = DIP_integration_process value = 10 }
		
		#Размер вассала - влияние на интеграцию 
		if = {
			limit = { is_subject_other_than_tributary_trigger = yes }
			trigger_switch = {
				on_trigger = total_development
				1001 = {
					divide_variable = { which = DIP_integration_process value = 0.05 }
				}
				751 = {
					divide_variable = { which = DIP_integration_process value = 0.25 }
				}
				501 = {
					divide_variable = { which = DIP_integration_process value = 0.75 }
				}
				251 = {
					divide_variable = { which = DIP_integration_process value = 1 }
				}
				151 = {
					divide_variable = { which = DIP_integration_process value = 1.25 }
				}
				101 = {
					divide_variable = { which = DIP_integration_process value = 1.5 }
				}
				51 = {
					divide_variable = { which = DIP_integration_process value = 1.75 }
				}
				1 = {
					divide_variable = { which = DIP_integration_process value = 2 }
				}
			}
		}
		
		#Флаг - обеспечить права религиозного лидера
		if = {
			limit = { has_country_flag = vassal_integration_dip_religious_rights }
			divide_variable = { which = DIP_integration_process value = 1.25 }
		}
		#Флаг - культурные меньшинства 
		if = {
			limit = { has_country_flag = vassal_integration_dip_cultural_minorites }
			divide_variable = { which = DIP_integration_process value = 1.3 }
		}
		#Флаг - династические союзы
		if = {
			limit = { has_country_flag = vassal_integration_dip_dinasty_alliance }
			divide_variable = { which = DIP_integration_process value = 1.3 }
		}
		#Флаг - Гарантированные привилегии
		if = {
			limit = { has_country_flag = vassal_integration_dip_garanted_privileges }
			divide_variable = { which = DIP_integration_process value = 0.5 }
		}
		
		#Наличие дин. брака с сюзереном
		if = {
			limit = { marriage_with = overlord }
			divide_variable = { which = DIP_integration_process value = 1.25 }
		}
		
		# Принят институт Народное сознание
		if = {
			limit = { has_institution = hhh_dt_l }
			divide_variable = { which = DIP_integration_process value = 0.85 }
		}
		# Принят институт Национализм
		if = {
			limit = { has_institution = nationalism_institution }
			divide_variable = { which = DIP_integration_process value = 0.75 }
		}
		
		# Сюзерен
		overlord = {
			# Советник
			if = {
				limit = { has_advisor = diplomat }
				PREV = { divide_variable = { which = DIP_integration_process value = 1.1 } }
			}
			
			# Принят институт Империализм
			if = {
				limit = { has_institution = imperialism }
				PREV = { divide_variable = { which = DIP_integration_process value = 1.35 } }
			}
			
			# Влияние технологий (Дип)
			if = {
				limit = { dip_tech = 50 }
				PREV = { divide_variable = { which = DIP_integration_process value = 2 } }
			}
			else_if = {
				limit = { dip_tech = 45 }
				PREV = { divide_variable = { which = DIP_integration_process value = 1.75 } }
			}
			else_if = {
				limit = { dip_tech = 30 }
				PREV = { divide_variable = { which = DIP_integration_process value = 1.45 } }
			}
			else_if = {
				limit = { dip_tech = 15 }
				PREV = { divide_variable = { which = DIP_integration_process value = 1.3 } }
			}
			else_if = {
				limit = { dip_tech = 5 }
				PREV = { divide_variable = { which = DIP_integration_process value = 1.15 } }
			}
			else_if = {
				limit = { dip_tech = 1 }
				PREV = { divide_variable = { which = DIP_integration_process value = 1.05 } }
			}
			
			# Влияние культуры и религии
			if = {
				limit = { primary_culture = PREV }
				PREV = { divide_variable = { which = DIP_integration_process value = 1.15 } }
			}
			else_if = {
				limit = { culture_group = PREV }
				PREV = { divide_variable = { which = DIP_integration_process value = 1.05 } }
			}
			if = {
				limit = { NOT = { religion = PREV } }
				PREV = { divide_variable = { which = DIP_integration_process value = 0.9 } }
			}
			else_if = {
				limit = { NOT = { religion_group = PREV } }
				PREV = { divide_variable = { which = DIP_integration_process value = 0.2 } }
			}
		
			# Влияние дипломатической репутации
			if = {
				limit = { diplomatic_reputation = -2 }
				PREV = { divide_variable = { which = DIP_integration_process value = 0.05 } }
			}
			else_if = {
				limit = { diplomatic_reputation = -1 }
				PREV = { divide_variable = { which = DIP_integration_process value = 0.1 } }
			}
			else_if = {
				limit = { diplomatic_reputation = 0 }
				PREV = { divide_variable = { which = DIP_integration_process value = 0.9 } }
			}
			else_if = {
				limit = { diplomatic_reputation = 0.5 }
				PREV = { divide_variable = { which = DIP_integration_process value = 1.25 } }
			}
			else_if = {
				limit = { diplomatic_reputation = 1 }
				PREV = { divide_variable = { which = DIP_integration_process value = 1.5 } }
			}
			else_if = {
				limit = { diplomatic_reputation = 2 }
				PREV = { divide_variable = { which = DIP_integration_process value = 1.75 } }
			}
		}
		
		#Подведение итога
		multiply_variable = { which = DIP_integration_process value = 10 }
		set_variable = { which = Remaining_Years_DIP which = DIP_integration_process }
		subtract_variable = { which = Remaining_Years_DIP which = Years_as_Vassal }
		
		set_variable = { which = PreSent_integration_DIP which = Years_as_Vassal }
		multiply_variable = { which = PreSent_integration_DIP value = 100 }
		if = {
			limit = {
				is_variable_equal = {
					which = DIP_integration_process
					value = 0
				}
			}
		}
		else = {
			divide_variable = {
				which = PreSent_integration_DIP
				which = DIP_integration_process
			}
		}
	}
}

vassals_mil_integration_effect = {
	#Военная интеграция
	every_subject_country = {
		limit = { 
			is_subject_of_type = vassal
			check_variable = { which = Years_as_Vassal value = 1 }
			NOT = { liberty_desire = 50 }
		}
		
		set_variable = { which = MIL_integration_process value = 10 }
		
		#Размер вассала - влияние на интеграцию 
		if = {
			limit = { is_subject_other_than_tributary_trigger = yes }
			trigger_switch = {
				on_trigger = total_development
				751 = {
					divide_variable = { which = MIL_integration_process value = 0.25 }
				}
				501 = {
					divide_variable = { which = MIL_integration_process value = 0.5 }
				}
				251 = {
					divide_variable = { which = MIL_integration_process value = 0.75 }
				}
				151 = {
					divide_variable = { which = MIL_integration_process value = 1 }
				}
				101 = {
					divide_variable = { which = MIL_integration_process value = 1.75 }
				}
				51 = {
					divide_variable = { which = MIL_integration_process value = 2.5 }
				}
				1 = {
					divide_variable = { which = MIL_integration_process value = 3 }
				}
			}
		}
		
		#Флаг - Лояльные офицеры
		if = {
			limit = { has_country_flag = vassal_integration_mil_loyalty_officers }
			divide_variable = { which = MIL_integration_process value = 1.25 }
		}
		#Флаг - Контроль над армией
		if = {
			limit = { has_country_flag = vassal_integration_mil_army_under_control }
			divide_variable = { which = MIL_integration_process value = 1.5 }
		}
		#Флаг - Гарантированные привилегии
		if = {
			limit = { has_country_flag = vassal_integration_mil_garanted_privileges }
			divide_variable = { which = MIL_integration_process value = 0.5 }
		}		
		
		# Принят институт Народное сознание
		if = {
			limit = { has_institution = hhh_dt_l }
			divide_variable = { which = MIL_integration_process value = 0.85 }
		}
		# Принят институт Национализм
		if = {
			limit = { has_institution = nationalism_institution }
			divide_variable = { which = MIL_integration_process value = 0.75 }
		}
		
		# Сюзерен
		overlord = {
			# Советник
			if = {
				limit = { has_advisor = army_organizer }
				PREV = { divide_variable = { which = MIL_integration_process value = 0.8 } }
			}
			
			# Принят институт Империализм
			if = {
				limit = { has_institution = imperialism }
				PREV = { divide_variable = { which = MIL_integration_process value = 1.35 } }
			}
			
			# Влияние технологий (Воен)
			if = {
				limit = { mil_tech = 50 }
				PREV = { divide_variable = { which = MIL_integration_process value = 1.1 } }
			}
			else_if = {
				limit = { mil_tech = 45 }
				PREV = { divide_variable = { which = MIL_integration_process value = 0.9 } }
			}
			else_if = {
				limit = { mil_tech = 30 }
				PREV = { divide_variable = { which = MIL_integration_process value = 0.6 } }
			}
			else_if = {
				limit = { mil_tech = 15 }
				PREV = { divide_variable = { which = MIL_integration_process value = 0.4 } }
			}
			else_if = {
				limit = { mil_tech = 5 }
				PREV = { divide_variable = { which = MIL_integration_process value = 0.2 } }
			}
			else_if = {
				limit = { mil_tech = 1 }
				PREV = { divide_variable = { which = MIL_integration_process value = 0.1 } }
			}
			
			# Влияние культуры и религии
			if = {
				limit = { primary_culture = PREV }
				PREV = { divide_variable = { which = MIL_integration_process value = 1.1 } }
			}
			else_if = {
				limit = { culture_group = PREV }
				PREV = { divide_variable = { which = MIL_integration_process value = 1.5 } }
			}
			if = {
				limit = { NOT = { religion = PREV } }
				PREV = { divide_variable = { which = MIL_integration_process value = 0.8 } }
			}
			else_if = {
				limit = { NOT = { religion_group = PREV } }
				PREV = { divide_variable = { which = MIL_integration_process value = 0.1 } }
			}
			
			# Влияние модификатора Низкой Организации
			if = {
				limit = { has_country_modifier = hhh_dark_times }
				divide_variable = { which = MIL_integration_process value = 0.8 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_light }
				divide_variable = { which = MIL_integration_process value = 0.7 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_s }
				divide_variable = { which = MIL_integration_process value = 0.6 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_s_light }
				divide_variable = { which = MIL_integration_process value = 0.5 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_t }
				divide_variable = { which = MIL_integration_process value = 0.4 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_t_light }
				divide_variable = { which = MIL_integration_process value = 0.3 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_l }
				divide_variable = { which = MIL_integration_process value = 0.2 }
			}
			else_if = {
				limit = { has_country_modifier = hhh_dark_times_l_light }
				divide_variable = { which = MIL_integration_process value = 0.1 }
			}
		}
		
		#Подведение итога
		multiply_variable = { which = MIL_integration_process value = 10 }
		set_variable = { which = Remaining_Years_MIL which = MIL_integration_process }
		subtract_variable = { which = Remaining_Years_MIL which = Years_as_Vassal }
		
		set_variable = { which = PreSent_integration_MIL which = Years_as_Vassal }
		multiply_variable = { which = PreSent_integration_MIL value = 100 }
		if = {
			limit = {
				is_variable_equal = {
					which = MIL_integration_process
					value = 0
				}
			}
		}
		else = {
			divide_variable = {
				which = PreSent_integration_MIL
				which = MIL_integration_process
			}
		}
	}
}